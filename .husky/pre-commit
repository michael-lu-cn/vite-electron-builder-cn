#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# 1. ä»£ç è´¨é‡æ£€æŸ¥
echo "ğŸ“ Checking code quality with Biome..."
pnpm lint
if [ $? -ne 0 ]; then
  echo "âŒ Lint check failed. Please fix the issues and try again."
  exit 1
fi

# 2. TypeScript ç±»å‹æ£€æŸ¥
echo "ğŸ”§ Running TypeScript type check..."
pnpm typecheck
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript check failed. Please fix the type errors and try again."
  exit 1
fi

# 3. æ„å»ºæ£€æŸ¥
echo "ğŸ—ï¸ Testing build..."
pnpm build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed. Please fix the build errors and try again."
  exit 1
fi

echo "âœ… All pre-commit checks passed!"
echo "ğŸ’¡ Tip: Run 'pnpm compile && pnpm test' to test the packaged app before pushing."
